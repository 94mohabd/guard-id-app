"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[473],{5473:(M,s,o)=>{o.r(s),o.d(s,{IdUploadBackComponent:()=>I});var d=o(467),c=o(5423),p=o(177),e=o(4438),g=o(3459);const m=["fileInput"];function _(t,l){1&t&&(e.j41(0,"div",12)(1,"span",13),e.EFF(2,"credit_card"),e.k0s(),e.j41(3,"div",14),e.nrm(4,"div",15)(5,"div",15)(6,"div",15)(7,"div",15),e.k0s()())}function u(t,l){1&t&&(e.j41(0,"div",16),e.EFF(1," Checking Image, please wait... "),e.nrm(2,"div",17),e.k0s())}function f(t,l){if(1&t&&(e.j41(0,"div",18)(1,"strong"),e.EFF(2,"Error: "),e.k0s(),e.EFF(3),e.k0s()),2&t){const r=e.XpG();e.R7$(3),e.SpI("",r.errorMessage," ")}}function v(t,l){if(1&t&&e.nrm(0,"img",19),2&t){const r=e.XpG();e.Y8G("src",r.previewUrl,e.B4B)}}function h(t,l){if(1&t){const r=e.RV6();e.j41(0,"div",20)(1,"button",21),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.uploadPhoto())}),e.EFF(2," Continue to Selfie "),e.k0s()()}}let I=(()=>{class t{constructor(r,n){this.imageVerificationService=r,this.router=n,this.selectedFile=null,this.previewUrl=null,this.isLoading=!1,this.errorMessage=null,this.isValidated=!1}ngOnInit(){const r=localStorage.getItem("backId");r&&(this.previewUrl=r,this.selectedFile=null,this.isValidated=!0)}triggerFileInput(){this.fileInput.nativeElement.click()}onFileSelected(r){var n=this;return(0,d.A)(function*(){const i=r.target;if(i.files&&i.files.length>0){n.selectedFile=i.files[0],n.errorMessage=null,n.isLoading=!0,n.isValidated=!1,n.previewUrl=null;try{const a=yield n.imageVerificationService.processBackIdImage(n.selectedFile);a.success?(n.previewUrl=a.previewUrl,n.selectedFile=a.resizedImage,n.isValidated=!0,a.previewUrl&&localStorage.setItem("backId",a.previewUrl)):(localStorage.removeItem("backId"),n.errorMessage=a.message)}catch{n.errorMessage="Error processing image. Please try again."}finally{n.isLoading=!1}}})()}uploadPhoto(){this.isValidated&&!this.errorMessage&&this.router.navigate(["/selfie"])}static{this.\u0275fac=function(n){return new(n||t)(e.rXU(g.s),e.rXU(c.Ix))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-id-upload-back"]],viewQuery:function(n,i){if(1&n&&e.GBs(m,5),2&n){let a;e.mGM(a=e.lsd())&&(i.fileInput=a.first)}},decls:21,vars:5,consts:[["fileInput",""],[1,"container","screen-enter"],[1,"header"],["routerLink","/id-upload-front",1,"back-button"],[1,"content"],[1,"upload-area",3,"click"],["class","id-placeholder",4,"ngIf"],["class","loading-message",4,"ngIf"],["class","error-message",4,"ngIf"],["alt","ID preview","class","preview-image",3,"src",4,"ngIf"],["type","file","accept","image/*",2,"display","none",3,"change"],["class","footer",4,"ngIf"],[1,"id-placeholder"],[1,"material-icons"],[1,"placeholder-lines"],[1,"line"],[1,"loading-message"],[1,"spinner"],[1,"error-message"],["alt","ID preview",1,"preview-image",3,"src"],[1,"footer"],[1,"primary-button",3,"click"]],template:function(n,i){if(1&n){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"a",3),e.EFF(3,"\u2190"),e.k0s()(),e.j41(4,"div",4)(5,"h2"),e.EFF(6,"Upload Back"),e.nrm(7,"br"),e.EFF(8,"of Your ID"),e.k0s(),e.j41(9,"p"),e.EFF(10,"Make sure the barcode is clear"),e.nrm(11,"br"),e.EFF(12,"and fully visible."),e.k0s(),e.j41(13,"div",5),e.bIt("click",function(){return e.eBV(a),e.Njj(i.triggerFileInput())}),e.DNE(14,_,8,0,"div",6)(15,u,3,0,"div",7)(16,f,4,1,"div",8)(17,v,1,1,"img",9),e.j41(18,"input",10,0),e.bIt("change",function(C){return e.eBV(a),e.Njj(i.onFileSelected(C))}),e.k0s()()(),e.DNE(20,h,3,0,"div",11),e.k0s()}2&n&&(e.R7$(14),e.Y8G("ngIf",!i.selectedFile&&!i.previewUrl),e.R7$(),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",i.errorMessage),e.R7$(),e.Y8G("ngIf",i.previewUrl),e.R7$(3),e.Y8G("ngIf",i.isValidated&&!i.errorMessage))},dependencies:[c.Wk,p.bT],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;padding:var(--spacing-lg)}.header[_ngcontent-%COMP%]{padding:var(--spacing-md) 0}.content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:center;padding-top:var(--spacing-xl);text-align:center}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:var(--spacing-md)}p[_ngcontent-%COMP%]{color:#666;margin-bottom:var(--spacing-xl)}.upload-area[_ngcontent-%COMP%]{border:2px dashed var(--border-color);border-radius:var(--border-radius-md);padding:var(--spacing-xl);width:100%;height:200px;display:flex;align-items:center;justify-content:center;margin:var(--spacing-lg) 0;cursor:pointer;position:relative}.id-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;color:#aaa}.id-placeholder[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:48px;margin-bottom:var(--spacing-md)}.placeholder-lines[_ngcontent-%COMP%]{width:120px}.line[_ngcontent-%COMP%]{height:8px;background-color:var(--medium-gray);margin-bottom:8px;border-radius:4px}.loading-message[_ngcontent-%COMP%]{color:var(--primary-color);text-align:center}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid var(--primary-color);border-top-color:transparent;border-radius:50%;margin:10px auto;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{color:#dc3545;text-align:center;margin-top:var(--spacing-md)}.preview-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain}.footer[_ngcontent-%COMP%]{padding:var(--spacing-lg) 0}"]})}}return t})()}}]);