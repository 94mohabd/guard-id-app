"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[76],{3459:(U,y,u)=>{u.d(y,{s:()=>R});var c=u(467),v=u(9350),F=u(7707);function h(i,w){const t="object"==typeof w;return new Promise((e,r)=>{const s=new F.Ms({next:a=>{e(a),s.unsubscribe()},error:r,complete:()=>{t?e(w.defaultValue):r(new v.G)}});i.subscribe(s)})}var f=u(4438),E=u(1626);let R=(()=>{class i{constructor(t){this.http=t,this.apiBaseUrl="https://guardid-dugdbpembqa0ega6.centralus-01.azurewebsites.net/api/Detection"}resizeImageTo1MB(t){var e=this;return(0,c.A)(function*(){return t.size<=1048576?t:new Promise((s,a)=>{const l=new FileReader;l.onload=z=>{const d=new Image;d.onload=()=>{const m=document.createElement("canvas"),I=m.getContext("2d");if(!I)return void a(new Error("Could not get canvas context"));let n=d.width,o=d.height;n>o?n>1024&&(o=Math.round(o*=1024/n),n=1024):o>1024&&(n=Math.round(n*=1024/o),o=1024),m.width=n,m.height=o,I.drawImage(d,0,0,n,o),m.toBlob(g=>{if(g)if(g.size>1048576){const p=new File([g],t.name,{type:"image/jpeg"});e.resizeImageTo1MB(p).then(s).catch(a)}else{const p=new File([g],t.name,{type:"image/jpeg",lastModified:t.lastModified});s(p)}else a(new Error("Could not create blob"))},"image/jpeg",.7)},d.onerror=()=>a(new Error("Error loading image")),d.src=z.target?.result},l.onerror=()=>a(new Error("Error reading file")),l.readAsDataURL(t)})})()}detectFaceInImage(t){var e=this;return(0,c.A)(function*(){const r=new FormData;r.append("imageFile",t);try{return yield h(e.http.post(`${e.apiBaseUrl}/detect-face`,r))}catch(s){throw e.parseErrorResponse(s)}})()}detectTextInImage(t){var e=this;return(0,c.A)(function*(){const r=new FormData;r.append("imageFile",t);try{return yield h(e.http.post(`${e.apiBaseUrl}/detect-text`,r))}catch(s){throw e.parseErrorResponse(s)}})()}detectBarcodeInImage(t){var e=this;return(0,c.A)(function*(){const r=new FormData;r.append("imageFile",t);try{return yield h(e.http.post(`${e.apiBaseUrl}/detect-barcode`,r))}catch(s){throw e.parseErrorResponse(s)}})()}processFrontIdImage(t){var e=this;return(0,c.A)(function*(){try{const r=yield e.resizeImageTo1MB(t),s=yield e.detectFaceInImage(r),a=yield e.detectTextInImage(r);return s.success?a.success?{success:!0,resizedImage:r,previewUrl:yield e.createPreviewUrl(r)}:{success:!1,message:a.message}:{success:!1,message:s.message}}catch(r){return{success:!1,message:r.message||"Error processing image"}}})()}processBackIdImage(t){var e=this;return(0,c.A)(function*(){try{const r=yield e.resizeImageTo1MB(t),s=yield e.detectBarcodeInImage(r);return s.success?{success:!0,resizedImage:r,previewUrl:yield e.createPreviewUrl(r)}:{success:!1,message:s.message}}catch(r){return{success:!1,message:r.message||"Error processing image"}}})()}processSelfieImage(t){var e=this;return(0,c.A)(function*(){try{const r=yield e.resizeImageTo1MB(t),s=yield e.detectFaceInImage(r);return s.success?{success:!0,resizedImage:r,previewUrl:yield e.createPreviewUrl(r)}:{success:!1,message:s.message}}catch(r){return{success:!1,message:r.message||"Error processing image"}}})()}createPreviewUrl(t){return new Promise((e,r)=>{const s=new FileReader;s.onload=a=>e(a.target?.result),s.onerror=()=>r(new Error("Error creating preview")),s.readAsDataURL(t)})}parseErrorResponse(t){let e={errorCode:"UNKNOWN_ERROR",message:"An unknown error occurred.",details:""};return t?.error&&(e={errorCode:t.error.errorCode||"UNKNOWN_ERROR",message:t.error.message||"An error occurred.",details:t.error.details||""}),e}static{this.\u0275fac=function(e){return new(e||i)(f.KVO(E.Qq))}}static{this.\u0275prov=f.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})()}}]);