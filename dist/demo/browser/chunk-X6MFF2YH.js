import{a as O}from"./chunk-AXO2SKNZ.js";import{e as U,f as P}from"./chunk-UQMFK6TD.js";import{Ba as C,Ea as h,La as s,Oa as a,Pa as r,Qa as c,Ra as _,Sa as f,Ta as v,Ua as w,Va as k,Wa as y,Xa as o,Y as g,Z as m,Za as M,c as I,qa as x,rb as b,sa as l,wa as u}from"./chunk-5MQG5VT3.js";var E=["fileInput"];function B(i,p){i&1&&(a(0,"div",12)(1,"span",13),o(2,"credit_card"),r(),a(3,"div",14),c(4,"div",15)(5,"div",15)(6,"div",15)(7,"div",15),r()())}function F(i,p){i&1&&(a(0,"div",16),o(1," Checking Image, please wait... "),c(2,"div",17),r())}function T(i,p){if(i&1&&(a(0,"div",18)(1,"strong"),o(2,"Error: "),r(),o(3),r()),i&2){let t=v();l(3),M("",t.errorMessage," ")}}function L(i,p){if(i&1&&c(0,"img",19),i&2){let t=v();s("src",t.previewUrl,x)}}function D(i,p){if(i&1){let t=_();a(0,"div",20)(1,"button",21),f("click",function(){g(t);let e=v();return m(e.uploadPhoto())}),o(2," Continue to Selfie "),r()()}}var N=(()=>{class i{constructor(t,n){this.imageVerificationService=t,this.router=n,this.selectedFile=null,this.previewUrl=null,this.isLoading=!1,this.errorMessage=null,this.isValidated=!1}ngOnInit(){let t=localStorage.getItem("backId");t&&(this.previewUrl=t,this.selectedFile=null,this.isValidated=!0)}triggerFileInput(){this.fileInput.nativeElement.click()}onFileSelected(t){return I(this,null,function*(){let n=t.target;if(n.files&&n.files.length>0){this.selectedFile=n.files[0],this.errorMessage=null,this.isLoading=!0,this.isValidated=!1,this.previewUrl=null;try{let e=yield this.imageVerificationService.processBackIdImage(this.selectedFile);e.success?(this.previewUrl=e.previewUrl,this.selectedFile=e.resizedImage,this.isValidated=!0,e.previewUrl&&localStorage.setItem("backId",e.previewUrl)):(localStorage.removeItem("backId"),this.errorMessage=e.message)}catch{this.errorMessage="Error processing image. Please try again."}finally{this.isLoading=!1}}})}uploadPhoto(){this.isValidated&&!this.errorMessage&&this.router.navigate(["/selfie"])}static{this.\u0275fac=function(n){return new(n||i)(u(O),u(U))}}static{this.\u0275cmp=C({type:i,selectors:[["app-id-upload-back"]],viewQuery:function(n,e){if(n&1&&w(E,5),n&2){let d;k(d=y())&&(e.fileInput=d.first)}},decls:21,vars:5,consts:[["fileInput",""],[1,"container","screen-enter"],[1,"header"],["routerLink","/id-upload-front",1,"back-button"],[1,"content"],[1,"upload-area",3,"click"],["class","id-placeholder",4,"ngIf"],["class","loading-message",4,"ngIf"],["class","error-message",4,"ngIf"],["alt","ID preview","class","preview-image",3,"src",4,"ngIf"],["type","file","accept","image/*",2,"display","none",3,"change"],["class","footer",4,"ngIf"],[1,"id-placeholder"],[1,"material-icons"],[1,"placeholder-lines"],[1,"line"],[1,"loading-message"],[1,"spinner"],[1,"error-message"],["alt","ID preview",1,"preview-image",3,"src"],[1,"footer"],[1,"primary-button",3,"click"]],template:function(n,e){if(n&1){let d=_();a(0,"div",1)(1,"div",2)(2,"a",3),o(3,"\u2190"),r()(),a(4,"div",4)(5,"h2"),o(6,"Upload Back"),c(7,"br"),o(8,"of Your ID"),r(),a(9,"p"),o(10,"Make sure the barcode is clear"),c(11,"br"),o(12,"and fully visible."),r(),a(13,"div",5),f("click",function(){return g(d),m(e.triggerFileInput())}),h(14,B,8,0,"div",6)(15,F,3,0,"div",7)(16,T,4,1,"div",8)(17,L,1,1,"img",9),a(18,"input",10,0),f("change",function(V){return g(d),m(e.onFileSelected(V))}),r()()(),h(20,D,3,0,"div",11),r()}n&2&&(l(14),s("ngIf",!e.selectedFile&&!e.previewUrl),l(),s("ngIf",e.isLoading),l(),s("ngIf",e.errorMessage),l(),s("ngIf",e.previewUrl),l(3),s("ngIf",e.isValidated&&!e.errorMessage))},dependencies:[P,b],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;padding:var(--spacing-lg)}.header[_ngcontent-%COMP%]{padding:var(--spacing-md) 0}.content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:center;padding-top:var(--spacing-xl);text-align:center}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:var(--spacing-md)}p[_ngcontent-%COMP%]{color:#666;margin-bottom:var(--spacing-xl)}.upload-area[_ngcontent-%COMP%]{border:2px dashed var(--border-color);border-radius:var(--border-radius-md);padding:var(--spacing-xl);width:100%;height:200px;display:flex;align-items:center;justify-content:center;margin:var(--spacing-lg) 0;cursor:pointer;position:relative}.id-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;color:#aaa}.id-placeholder[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:48px;margin-bottom:var(--spacing-md)}.placeholder-lines[_ngcontent-%COMP%]{width:120px}.line[_ngcontent-%COMP%]{height:8px;background-color:var(--medium-gray);margin-bottom:8px;border-radius:4px}.loading-message[_ngcontent-%COMP%]{color:var(--primary-color);text-align:center}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid var(--primary-color);border-top-color:transparent;border-radius:50%;margin:10px auto;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{color:#dc3545;text-align:center;margin-top:var(--spacing-md)}.preview-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain}.footer[_ngcontent-%COMP%]{padding:var(--spacing-lg) 0}"]})}}return i})();export{N as IdUploadBackComponent};
